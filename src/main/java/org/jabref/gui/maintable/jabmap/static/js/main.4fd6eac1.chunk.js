(this["webpackJsonpmind-map"]=this["webpackJsonpmind-map"]||[]).push([[0],{104:function(e,t,n){},174:function(e,t,n){e.exports=n(393)},178:function(e,t,n){},226:function(e,t,n){},392:function(e,t,n){},393:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(14),c=n.n(o),i=(n(178),n(39)),l=n(57),d=n.n(l),s=n(101),u=n(29),f=n(152),m=n(24),p=(n(104),n(16)),h=function(e){var t=e.node,n=(e.id,e.colors,e.updateEdges),a=e.setSelectedNode,o=e.selectedNodeId,c=e.updateNode,i=(e.label,e.bibEntryId,e.isInSearch);return r.a.createElement(p.Group,{id:t.id,x:t.x_pos,y:t.y_pos,draggable:!0,onDragMove:function(e){t.x_pos=e.target.x(),t.y_pos=e.target.y(),c(t),n(t.id,e.target.x(),e.target.y())},onClick:function(){return a(t)},onMouseEnter:function(e){e.target.getStage().container().style.cursor="pointer"},onMouseLeave:function(e){e.target.getStage().container().style.cursor="default"}},r.a.createElement(p.Rect,{radius:{x:50,y:30},width:150,height:70,offsetX:75,offsetY:35,cornerRadius:20,fill:i?"#3f51b5":o===t.id?"#a2b8e5":"white",stroke:void 0===t.colour?"#6E6E6E":t.colour,strokeWidth:4}),r.a.createElement(p.Text,{text:t.label,offsetX:75,offsetY:45,align:"center",verticalAlign:"middle",width:150,height:70}),r.a.createElement(p.Group,{width:150,height:70,offsetX:65,offsetY:-15},t.citationKey&&r.a.createElement(p.Rect,{width:10,height:10,fill:"red"})))},g=function(e){var t=e.x1,n=e.y1,a=e.x2,o=e.y2,c={st:[t,n],ct:[t,o,t,o],en:[a,o]};return r.a.createElement(p.Shape,{stroke:"#50618F",strokeWidth:6,lineCap:"round",sceneFunc:function(e,t){e.beginPath(),e.moveTo.apply(e,Object(i.a)(c.st)),e.bezierCurveTo.apply(e,Object(i.a)(c.ct).concat(Object(i.a)(c.en))),e.strokeShape(t)}})},E=n(420),b=function(e){var t=e.nodes,n=e.edges,a=e.updateEdges,o=e.setSelectedNode,c=e.selectedNodeId,i=e.updateNode;Object(E.a)({canvas:{left:"25%",position:"absolute"}})();return r.a.createElement(p.Group,{x:310},n.map((function(e){return r.a.createElement(g,{x1:e.startX,y1:e.startY,x2:e.endX,y2:e.endY})})),t.map((function(e){return r.a.createElement(h,{node:e,key:e.id,label:e.label,colors:e.colors,id:e.id,x:e.x_pos,y:e.y_pos,colour:e.colour,updateEdges:a,selectedNodeId:c,setSelectedNode:o,updateNode:i,isInSearch:e.isInSearch})})))};r.a.memo((function(e){var t=e.references,n=(e.setReferences,e.addNode),o=e.layerRef,c=e.stageRef,i=(Object(E.a)({table:{position:"absolute",left:0,top:0,maxWidth:"25%",overflow:"hidden",tableLayout:"fixed",height:"100vh",backgroundColor:"#e1e1e1"}})(),t.length),l=r.a.useRef([]);return l.current.length!==i&&(l.current=Array(i).fill().map((function(e,t){return l.current[t]||Object(a.createRef)()}))),r.a.createElement(p.Group,null,t.map((function(e,t){return r.a.createElement(p.Group,null,r.a.createElement(p.Group,{y:110*t},r.a.createElement(p.Rect,{width:300,height:100,fill:"#dddddd"}),r.a.createElement(p.Text,{text:e.title,x:150,y:50,width:100,height:60})),r.a.createElement(p.Group,{opacity:.5,draggable:!0,ref:l.current[t],position:{x:0,y:110*t},onDragEnd:function(){l.current[t].current.position({x:0,y:110*t}),o.current.draw();var a=c.current.getPointerPosition(),r=a.x,i=a.y;n(e,r-300,i,e.citekey)}},r.a.createElement(p.Rect,{width:300,height:100,fill:"#dddddd"}),r.a.createElement(p.Text,{text:e.title,x:150,y:50,width:100,height:60})))})))}));function y(){var e=window;return{windowWidth:e.innerWidth,windowHeight:e.innerHeight}}function v(){var e=Object(a.useState)(y()),t=Object(m.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){function e(){r(y())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}var w=n(423),x=(n(226),n(394)),O=n(432),j=n(157),N=n.n(j),k=n(162),I=n.n(k),S=n(160),R=n.n(S),_=n(161),C=n.n(_),L=n(159),A=n.n(L),P=n(158),Y=n.n(P),z=r.a.memo((function(e){var t=e.addNode,n=e.saveMap,o=e.deleteNode,c=e.searchNodes,i=e.linking,l=e.setLinking,d=(Object(E.a)({toolbar:{width:"100%",textAlign:"center"}})(),Object(a.useRef)(null));return window.onkeydown=function(e){(114===e.keyCode||e.ctrlKey&&70===e.keyCode)&&(e.preventDefault(),d.current.focus())},r.a.createElement(w.a,{className:"Toolbar-proportions",component:x.a},r.a.createElement("div",{style:{borderRight:"0.1em solid grey",padding:"0.5em"}},r.a.createElement(O.a,{size:"small","aria-label":"add",onClick:function(){return t()}},r.a.createElement(N.a,null)),r.a.createElement(O.a,{size:"small",onClick:function(){return l(!i)},color:i?"primary":"default"},r.a.createElement(Y.a,null)),r.a.createElement(O.a,{size:"small",onClick:o},r.a.createElement(A.a,null))),r.a.createElement("div",{style:{borderRight:"0.1em solid grey",padding:"0.5em"}},r.a.createElement(O.a,{size:"small",style:{marginRight:10}},r.a.createElement(R.a,null)),r.a.createElement(O.a,{size:"small"},r.a.createElement(C.a,null))),r.a.createElement(O.a,{size:"small",onClick:function(){return n()},style:{paddingLeft:"0.5em"}},r.a.createElement(I.a,null)),r.a.createElement("div",{style:{align:"right",padding:"0.5em"}},r.a.createElement("select",{style:{border:"none",textAlign:"centre",fontSize:12,marginRight:50,marginLeft:30}},r.a.createElement("option",{value:"noFilter"}," No Filter "),r.a.createElement("option",{value:"highPriority"}," High Priority "),r.a.createElement("option",{value:"favourites"}," Low Priority "),r.a.createElement("option",{value:"favourites"}," Favourites ")),r.a.createElement("input",{type:"text",id:"searchnode",onChange:c,ref:d,placeholder:"\ud83d\udd0eNode Search",size:"30"})))})),T=n(163),X=n(425),F=n(427),W=n(428),B=n(429),D=n(430),M=n(426),G=n(431),H=function(e){var t=e.node,n=e.reference,o=e.updateNode,c=e.changeNodeColor,i=Object(E.a)({panel:{position:"absolute",top:74,right:10,width:"300px",backgroundColor:"white","& td":{border:"none",padding:"10px"}}})(),l=Object(a.useRef)(),d=Object(a.useState)(),s=Object(m.a)(d,2),u=s[0],f=s[1];Object(a.useEffect)((function(){f(t.label),l.current.focus()}),[t]);return r.a.createElement(X.a,{className:i.panel},r.a.createElement(M.a,{gutterBottom:!0,variant:"h4",component:"h4",style:{textAlign:"center"}},"Node Info"),r.a.createElement(G.a,{style:{width:"calc(100% - 20px)",marginBottom:"10px",marginLeft:"10px"},InputLabelProps:{shrink:!0},id:"standard-basic",label:"Label",value:u,type:"text",inputRef:l,onChange:function(e){f(e.target.value),t.label=e.target.value,o(t)}}),r.a.createElement(F.a,{key:"colorEditor"},r.a.createElement(W.a,{component:"td",scope:"row",style:{border:"none",color:"#3f51b5"}},"Color:"),r.a.createElement(W.a,{component:"td",scope:"row",style:{border:"none"}},r.a.createElement(T.CirclePicker,{colors:["#BA1D2A","#FC6A38","#FCF1A4","#0A9F90","#0E5756"],onChange:c}))),n&&r.a.createElement(B.a,{className:i.table,"aria-label":"simple table"},r.a.createElement(M.a,{gutterBottom:!0,style:{paddingLeft:"10px",margin:0},variant:"h5",component:"h5"},"BibEntry"),r.a.createElement(D.a,null,r.a.createElement(F.a,{key:n.title},r.a.createElement(W.a,{component:"td",scope:"row",style:{color:"#3f51b5"}},"Title:"),r.a.createElement(W.a,{component:"td",scope:"row"},n.title)),r.a.createElement(F.a,{key:n.author},r.a.createElement(W.a,{component:"td",scope:"row",style:{color:"#3f51b5"}},"Author:"),r.a.createElement(W.a,{component:"td",scope:"row"},n.author)),r.a.createElement(F.a,{key:n.year},r.a.createElement(W.a,{component:"td",scope:"row",style:{color:"#3f51b5"}},"Year:"),r.a.createElement(W.a,{component:"td",scope:"row"},n.year)))))},K=(n(392),r.a.memo((function(e){var t=e.references,n=(e.setReferences,e.draggedRow),a=(e.addNode,v()),o=a.windowHeight;a.windowWidth;return r.a.createElement("div",{className:"Table-proportions",style:{maxHeight:o-70}},r.a.createElement(X.a,{style:{width:"99.5%"}},r.a.createElement(M.a,{gutterBottom:!0,variant:"h4",component:"h4",style:{textAlign:"center"}},"References"),r.a.createElement("div",null,r.a.createElement(B.a,{hover:!0,size:"sm",className:"table-striped"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Title"),r.a.createElement("th",null,"Author"),r.a.createElement("th",null,"Year"))),r.a.createElement("tbody",null,t&&t.map((function(e){return r.a.createElement(F.a,{key:e,draggable:!0,onDragStart:function(t){n.current=e}},r.a.createElement("td",null,e.title),r.a.createElement("td",null,e.author),r.a.createElement("td",null,e.year))})))))))})));var J=function(){var e=Object(a.useState)([]),t=Object(m.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)([]),l=Object(m.a)(c,2),h=l[0],g=l[1],y=Object(a.useState)([{}]),w=Object(m.a)(y,2),x=w[0],O=w[1],j=Object(a.useState)({}),N=Object(m.a)(j,2),k=N[0],I=N[1],S=Object(a.useState)(4),R=Object(m.a)(S,2),_=(R[0],R[1],Object(a.useState)(!1)),C=Object(m.a)(_,2),L=C[0],A=C[1],P=function(e){L?(D(k,e),A(!1),I(e)):I(e)},Y=function(e){var t=n.map((function(t){return e.id===t.id?e:t}));o(t)},T=function(e){n.forEach((function(t){e.indexOf(t.id)>-1?t.isInSearch=!0:t.isInSearch=!1,Y(t)}))},X=Object(E.a)({wrapper:{position:"relative"},canvas:{left:"25%",position:"absolute"}})(),F=function(){var e=Object(s.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("http://localhost:9898/libraries/current/map").then((function(e){return e.json()})).then((function(e){o(e.nodes.map((function(e){return-1===e.id?Object(u.a)(Object(u.a)({},e),{},{x_pos:$/8,y_pos:U/3}):e}))),g(e.edges.map((function(t){var n=e.nodes.find((function(e){return e.id===t.node1_Id})),a=e.nodes.find((function(e){return e.id===t.node2_Id}));return{startId:t.node1_Id,startX:n.x_pos,startY:n.y_pos,endId:t.node2_Id,endX:a.x_pos,endY:a.y_pos}})))})).catch(console.log);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(s.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("http://localhost:9898/libraries/current/entries").then((function(e){return e.json()})).then((function(e){O(e)})).catch(console.log);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){W(),F(),console.log(k)}),[]);var B=function(e,t,a){if(void 0!==k.id){var r,c;console.log(k),void 0===e?r="New Node":(c=e.citekey,r=e.title),void 0===t&&(t=0),void 0===a&&(a=400);var l={id:Math.floor(1e9*Math.random()),label:r,x_pos:t,y_pos:a,citationKey:c};o([].concat(Object(i.a)(n),[l])),D(k,l),P(l)}},D=function(e,t){if(e.id!==t.id){var n={startId:e.id,startX:e.x_pos,startY:e.y_pos,endId:t.id,endX:t.x_pos,endY:t.y_pos};g([].concat(Object(i.a)(h),[n]))}},M=Object(a.useRef)(),G=Object(a.useRef)(),J=v(),U=J.windowHeight,$=J.windowWidth,q=Object(a.useRef)();return r.a.createElement("div",{className:X.wrapper},r.a.createElement(z,{addNode:B,saveMap:function(){var e=h.map((function(e){return{node1_Id:e.startId,node2_Id:e.endId}})),t=JSON.stringify({nodes:n,edges:e});fetch("http://localhost:9898/libraries/current/map",{method:"PUT",headers:{"Content-Type":"application/json"},body:t})},deleteNode:function(){void 0!==k.id&&(o(n.filter((function(e){return e.id!==k.id}))),g(h.filter((function(e){return e.startId!==k.id&&e.endId!==k.id}))))},searchNodes:function(e){var t=e.target.value,a=[];""!==t?(n.forEach((function(e){e.label.indexOf(t)>-1&&a.push(e.id)})),T(a)):T(a)},linking:L,setLinking:A}),r.a.createElement(K,{draggedRow:q,addNode:B,references:x,setReferences:O}),r.a.createElement("div",{onDrop:function(e){G.current.setPointersPositions(e);var t=G.current.getPointerPosition(),n=t.x,a=t.y;B(q.current,n-.25*U-75,a)},onDragOver:function(e){return e.preventDefault()}},r.a.createElement(p.Stage,{style:{left:"25%",position:"absolute",top:"64px",margin:0,padding:0},width:.75*$,height:U-64,ref:G},r.a.createElement(p.Layer,{ref:M},r.a.createElement(b,{nodes:n,edges:h,updateEdges:function(e,t,n){var a=h.map((function(a){return a.startId===e?Object(u.a)(Object(u.a)({},a),{},{startX:t,startY:n}):a.endId===e?Object(u.a)(Object(u.a)({},a),{},{endX:t,endY:n}):a}));g(a)},updateNode:Y,selectedNodeId:k.id,setSelectedNode:P,updateSearchIndex:T})))),k.id?r.a.createElement(H,{node:k,reference:function(e){var t,n=Object(f.a)(x);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.citekey===e)return a}}catch(r){n.e(r)}finally{n.f()}}(k.citationKey),updateNode:Y,changeNodeColor:function(e,t){!function(e,t){var a=n.map((function(n){return n.id===e?Object(u.a)(Object(u.a)({},n),{},{colour:t}):n}));o(a)}(k.id,e.hex)}}):r.a.createElement(H,{node:k,updateNode:Y}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[174,1,2]]]);
//# sourceMappingURL=main.4fd6eac1.chunk.js.map